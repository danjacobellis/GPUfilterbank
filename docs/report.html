

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Notebook to PDF (as a document) &mdash; GPU Filter Bank  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/togglebutton.css" type="text/css" />
  <link rel="stylesheet" href="_static/mystnb.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/togglebutton.js"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> GPU Filter Bank
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="dyadic.html">Dyadic Filter Banks</a></li>
<li class="toctree-l1"><a class="reference internal" href="dyadic.html#octave-spaced-analysis-filter-bank">Octave Spaced Analysis Filter Bank</a></li>
<li class="toctree-l1"><a class="reference internal" href="dyadic.html#balanced-analysis-filter-bank">Balanced Analysis Filter Bank</a></li>
<li class="toctree-l1"><a class="reference internal" href="dyadic.html#display">Display</a></li>
<li class="toctree-l1"><a class="reference internal" href="dyadic.html#balanced-synthesis-filter-bank">Balanced Synthesis Filter Bank</a></li>
<li class="toctree-l1"><a class="reference internal" href="dyadic.html#synthesis-filter-bank">Synthesis Filter Bank</a></li>
<li class="toctree-l1"><a class="reference internal" href="denoise.html">Dyadic Filter Banks</a></li>
<li class="toctree-l1"><a class="reference internal" href="denoise.html#octave-spaced-analysis-filter-bank">Octave Spaced Analysis Filter Bank</a></li>
<li class="toctree-l1"><a class="reference internal" href="denoise.html#balanced-analysis-filter-bank">Balanced Analysis Filter Bank</a></li>
<li class="toctree-l1"><a class="reference internal" href="denoise.html#display-and-denoise">Display and denoise</a></li>
<li class="toctree-l1"><a class="reference internal" href="denoise.html#balanced-synthesis-filter-bank">Balanced Synthesis Filter Bank</a></li>
<li class="toctree-l1"><a class="reference internal" href="denoise.html#octave-synthesis-filter-bank">Octave Synthesis Filter Bank</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">GPU Filter Bank</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Notebook to PDF (as a document)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/report.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="tex2jax_ignore mathjax_ignore section" id="notebook-to-pdf-as-a-document">
<h1>Notebook to PDF (as a document)<a class="headerlink" href="#notebook-to-pdf-as-a-document" title="Permalink to this headline">¶</a></h1>
<p><code class="docutils literal notranslate"><span class="pre">jupyter-nbconvert</span> <span class="pre">report.ipynb</span> <span class="pre">--to</span> <span class="pre">pdf</span> <span class="pre">-TagRemovePreprocessor.remove_cell_tags='{&quot;remove_cell&quot;}'</span> <span class="pre">--template</span> <span class="pre">template.tplx</span></code></p>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="notebook-to-slide-deck">
<h1>Notebook to slide deck<a class="headerlink" href="#notebook-to-slide-deck" title="Permalink to this headline">¶</a></h1>
<p><code class="docutils literal notranslate"><span class="pre">jupyter-nbconvert</span> <span class="pre">report.ipynb</span> <span class="pre">--to</span> <span class="pre">slides</span> <span class="pre">--TagRemovePreprocessor.remove_input_tags={\&quot;remove-input\&quot;}</span> <span class="pre">--post</span> <span class="pre">serve</span> <span class="pre">--ServePostProcessor.port=9997</span> <span class="pre">--ServePostProcessor.ip=&quot;0.0.0.0&quot;</span></code></p>
<p>http://72.179.3.141:9997/nov8.slides.html</p>
<p>To convert to pdf, add ?print-pdf to URL, i.e.</p>
<p>http://72.179.3.141:9997/nov8.slides.html?print-pdf</p>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="gpu-filter-banks-for-audio">
<h1>GPU Filter Banks for Audio<a class="headerlink" href="#gpu-filter-banks-for-audio" title="Permalink to this headline">¶</a></h1>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="abstract">
<h1>Abstract<a class="headerlink" href="#abstract" title="Permalink to this headline">¶</a></h1>
<p>In our project, we implement a class of perfect-reconstruction filterbanks for audio analysis. We exploit parallelism across CPU threads for part of our algorithm and use a GPU to solve embarassingly parallel subtasks. We also introduce a novel type of time-frequency tiling which retains the benefits of constant-Q transforms without requiring their cumbersome data structure.</p>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="background">
<h1>Background<a class="headerlink" href="#background" title="Permalink to this headline">¶</a></h1>
<p>For audio signal processing problems such as compression, denoising, and various types of pattern recognition, deep learning has taken over. For example, the search interest for “wavelet” has followed the opposite trajectory as “convolutional neural network”</p>
<p><img alt="" src="_images/trends1.png" /></p>
<p>A current trend of audio signal processing research is to apply 2D convolutional neural networks to time-frequency representations of audio. Although great progress was made in the pre-deep learning era on perfect reconstruction filterbanks and wavelet transforms, most of the algorithms and techniques have been abandoned by practitioners of deep learning because no standardized and free implementations were ever widely disseminated. As a result, the standarized set of triangular “Mel” filterbanks dating back nearly 50 years appears to have remained the dominant tool, and have even seen a resurgance despite their <a class="reference external" href="https://asmp-eurasipjournals.springeropen.com/articles/10.1186/s13636-021-00217-4">impending obsolescence.</a></p>
<p><img alt="" src="_images/trends2.png" /></p>
<p>The use of these methods is accumulating a considerable debt. Compared to the most recent iterations of constant-Q filterbanks, these methods for time-frequency analysis lack several desirable properties</p>
<ul class="simple">
<li><p>Parameterization/tunability</p></li>
<li><p>Perfect reconstruction</p></li>
<li><p>Meaningful/interpretable phase representation</p></li>
<li><p>Generalization to multiple channels/phased arrays</p></li>
<li><p>Efficient implementation for oversampled representations.</p></li>
</ul>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="filter-banks-and-wavelet-transforms">
<h1>Filter Banks and Wavelet Transforms<a class="headerlink" href="#filter-banks-and-wavelet-transforms" title="Permalink to this headline">¶</a></h1>
<p>Filter banks are the oldest method of time-frequency analysis, dating back to the first analog spectrum analyzer built by Hermann von Helmholtz in the 19th century.</p>
<p><img alt="" src="_images/helmholtz.png" /></p>
<p>In 1909, mathematician Alfréd Haar discovered that a list of <span class="math notranslate nohighlight">\(2^n\)</span> numbers can be represented by recursively taking the sum and difference of adjacent pairs. This property is now commonly referred to ‘alias cancellation’</p>
<p>In the 1970s, engineers created the first discrete, invertible filterbanks by expoiting this property. Using what are known as ‘conjugate mirror filters’. In the following decade, a massive research effort took place, resulting in a rigorous mathematical understanding of these processes and the development of various “wavelet transforms.”</p>
<p>Unfortunately, deep learning has begun to displace these techniques in education, leading to considerable confusion and technical debt.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="n">DSP</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="haar-decomposition">
<h1>Haar Decomposition<a class="headerlink" href="#haar-decomposition" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">round</span><span class="o">.</span><span class="p">(</span><span class="kt">Int</span><span class="p">,</span><span class="mi">10</span><span class="o">*</span><span class="n">randn</span><span class="p">(</span><span class="mi">8</span><span class="p">));</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[7, 1, -13, 20, 4, 7, -18, 5]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">conv</span><span class="p">(</span><span class="n">x</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])[</span><span class="mi">2</span><span class="o">:</span><span class="mi">2</span><span class="o">:</span><span class="k">end</span><span class="p">];</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">conv</span><span class="p">(</span><span class="n">x</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])[</span><span class="mi">2</span><span class="o">:</span><span class="mi">2</span><span class="o">:</span><span class="k">end</span><span class="p">];</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">println</span><span class="p">(</span><span class="s">&quot;s = &quot;</span><span class="p">,</span><span class="n">s</span><span class="p">);</span> <span class="n">print</span><span class="p">(</span><span class="s">&quot;d = &quot;</span><span class="p">,</span><span class="n">d</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>s = [8, 7, 11, -13]
d = [-6, 33, 3, 23]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">y1</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="o">-</span><span class="n">d</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
<span class="n">y2</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="o">+</span><span class="n">d</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">println</span><span class="p">(</span><span class="kt">Int</span><span class="o">.</span><span class="p">(</span><span class="n">y1</span><span class="p">));</span> <span class="n">print</span><span class="p">(</span><span class="kt">Int</span><span class="o">.</span><span class="p">(</span><span class="n">y2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[7, -13, 4, -18]
[1, 20, 7, 5]
</pre></div>
</div>
</div>
</div>
<p>This is an example of a <strong>critically sampled</strong> dyadic filterbank</p>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="time-frequency-tiling">
<h1>Time-frequency tiling<a class="headerlink" href="#time-frequency-tiling" title="Permalink to this headline">¶</a></h1>
<p>Decomposing the lower branch produces octave filters</p>
<p>img/dyadic_analysis_filterbank.svg</p>
<p><img alt="" src="_images/octave_tiling.png" /></p>
<p>Decomposing both branches (balanced tree)</p>
<p>(uniform grid of rectangles)</p>
<p>you can have anything in the middle</p>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="dwt-sequential-time-complexity">
<h1>DWT Sequential time complexity<a class="headerlink" href="#dwt-sequential-time-complexity" title="Permalink to this headline">¶</a></h1>
<p>each level is N log N</p>
<p>log N levels</p>
<p>between N log N and N (log N)^2</p>
<p>regardless of how many levels you go down</p>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="parallel-fft-complexity-and-therefore-convolution">
<h1>parallel fft complexity (and therefore convolution)<a class="headerlink" href="#parallel-fft-complexity-and-therefore-convolution" title="Permalink to this headline">¶</a></h1>
<p>log N levels</p>
<p>each level n/p computation</p>
<p>(N/p) log N</p>
<p>parallel DWT is</p>
<p>(N/p) (log N)^2</p>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="input-size">
<h1>Input size<a class="headerlink" href="#input-size" title="Permalink to this headline">¶</a></h1>
<p>Speech: few seconds long, fs = 16000, N ~ 10^5 per record.</p>
<p>Music: minutes long, two channels, fs = 48000, N ~ 10^7 per record.</p>
<p>Passive sonar array: 100s of channels, fs in the kHz, ~ 10^10 per hour.</p>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="data-pipeline">
<h1>Data pipeline<a class="headerlink" href="#data-pipeline" title="Permalink to this headline">¶</a></h1>
<p>Speech and music are nearly always compressed. Typical compression ratio is 10:1</p>
<p>Phased array data often minimally compressed and stored on cheap magnetic tape.</p>
<p>Often helpful to combine PRAM and GPU computation models.</p>
<p>Multiple CPUs can increase the rate at which data is decoded and communicated to the GPU(s)</p>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="generalization-to-other-filters">
<h1>Generalization to other filters<a class="headerlink" href="#generalization-to-other-filters" title="Permalink to this headline">¶</a></h1>
<p>You need alias cancellation</p>
<p>https://en.wikipedia.org/wiki/Quadrature_mirror_filter</p>
<p>As long as you satisfy this condition, you can use better filters</p>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="discrete-wavelet-transform">
<h1>Discrete wavelet transform<a class="headerlink" href="#discrete-wavelet-transform" title="Permalink to this headline">¶</a></h1>
<p>Generalizes this idea</p>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="goal">
<h1>Goal<a class="headerlink" href="#goal" title="Permalink to this headline">¶</a></h1>
<p>Generalize these types of transformations to</p>
<ul class="simple">
<li><p>Filters with greater frequency selectivity</p></li>
<li><p>Oversampled filters</p></li>
<li><p>Undersampled filters</p></li>
</ul>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="gpu-convolution">
<h1>GPU convolution<a class="headerlink" href="#gpu-convolution" title="Permalink to this headline">¶</a></h1>
<p>what is CUDA doing?</p>
<p>https://docs.nvidia.com/deeplearning/cudnn/developer-guide/index.html</p>
<p>If you repeat your data and construct</p>
<p>https://en.wikipedia.org/wiki/Toeplitz_matrix</p>
<p>Then convolution is equivalent to matrix multiply</p>
<p>Not actually doing matrix multiplication, but create a mapping from “virtual matrix” to corresponding array location</p>
<p>(fold in some of the theory from lecture on mat mul)</p>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="parallel-fft-algorithms">
<h1>Parallel FFT algorithms<a class="headerlink" href="#parallel-fft-algorithms" title="Permalink to this headline">¶</a></h1>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="decimation-filterbank">
<h1>Decimation filterbank<a class="headerlink" href="#decimation-filterbank" title="Permalink to this headline">¶</a></h1>
<p>filter then downsample</p>
<p>!= dilation + stride (but close)</p>
<p>show toeplitz matrix multiplication with upsampling/downsampling</p>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="polyphase-filterbank">
<h1>Polyphase filterbank<a class="headerlink" href="#polyphase-filterbank" title="Permalink to this headline">¶</a></h1>
<p>upsample then filter</p>
<p>?= transposed convolution with dilation and stride</p>
<p>Another oppurtunity to add CPU parallelism</p>
<p>show mathematically that it’s equivalent to splitting filter into L pieces where L is the upsampling factor, and applying filters in parallel</p>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="oversampled-filterbanks">
<h1>Oversampled filterbanks<a class="headerlink" href="#oversampled-filterbanks" title="Permalink to this headline">¶</a></h1>
<p>You get exploit more CPU parallelism</p>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="undersampled-filterbanks">
<h1>Undersampled filterbanks<a class="headerlink" href="#undersampled-filterbanks" title="Permalink to this headline">¶</a></h1>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="demo-our-program">
<h1>Demo our program<a class="headerlink" href="#demo-our-program" title="Permalink to this headline">¶</a></h1>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="analysis-filterbank">
<h1>Analysis filterbank<a class="headerlink" href="#analysis-filterbank" title="Permalink to this headline">¶</a></h1>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="processing">
<h1>Processing<a class="headerlink" href="#processing" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p>denoising</p></li>
<li><p>compression</p></li>
<li><p>source separation</p></li>
</ul>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="synthesis-filterbank">
<h1>Synthesis filterbank<a class="headerlink" href="#synthesis-filterbank" title="Permalink to this headline">¶</a></h1>
</div>


           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>